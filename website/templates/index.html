<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–†–æ–∑–∫–ª–∞–¥ –∑–∞–Ω—è—Ç—å</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
</head>
<body>
    <div class="container">
        <h1>–†–æ–∑–∫–ª–∞–¥ –∑–∞–Ω—è—Ç—å</h1>

        <!-- –ö–Ω–æ–ø–∫–∞ –ø–µ—Ä–µ–º–∏–∫–∞–Ω–Ω—è —Ç–µ–º–∏ –∑ —ñ–∫–æ–Ω–∫–æ—é -->
        <button id="theme-toggle" class="theme-button" title="–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç–∏ —Ç–µ–º—É">
            <span class="theme-icon">‚òÄÔ∏è</span>
        </button>

        <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
        {% if stats.total_lessons > 0 %}
        <div class="stats">
            <p>–£—Å—å–æ–≥–æ –∑–∞–Ω—è—Ç—å: {{ stats.total_lessons }}</p>
            <p>–õ–µ–∫—Ü—ñ–π: {{ stats.lectures }}</p>
            <p>–õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∏—Ö: {{ stats.labs }}</p>
        </div>
        {% endif %}

        <!-- –§–æ—Ä–º–∞ –ø–æ—à—É–∫—É -->
        <form method="POST" class="search-form">
            <input type="text" name="search_query" placeholder="–í–≤–µ–¥—ñ—Ç—å –∑–∞–ø–∏—Ç (–Ω–∞–ø—Ä., –Ü–≤–∞–Ω–æ–≤, –ö–ù-21)" value="{{ request.form.get('search_query', '') }}">
            <select name="search_field">
                <option value="all" {% if request.form.get('search_field') == 'all' %}selected{% endif %}>–£—Å—ñ –ø–æ–ª—è</option>
                <option value="teacher" {% if request.form.get('search_field') == 'teacher' %}selected{% endif %}>–í–∏–∫–ª–∞–¥–∞—á</option>
                <option value="group" {% if request.form.get('search_field') == 'group' %}selected{% endif %}>–ì—Ä—É–ø–∞/–ü—ñ–¥–≥—Ä—É–ø–∞</option>
                <option value="discipline" {% if request.form.get('search_field') == 'discipline' %}selected{% endif %}>–î–∏—Å—Ü–∏–ø–ª—ñ–Ω–∞</option>
                <option value="classroom" {% if request.form.get('search_field') == 'classroom' %}selected{% endif %}>–ê—É–¥–∏—Ç–æ—Ä—ñ—è</option>
            </select>
            <select name="day_filter">
                <option value="all" {% if request.form.get('day_filter') == 'all' %}selected{% endif %}>–£—Å—ñ –¥–Ω—ñ</option>
                <option value="Monday" {% if request.form.get('day_filter') == 'Monday' %}selected{% endif %}>–ü–æ–Ω–µ–¥—ñ–ª–æ–∫</option>
                <option value="Tuesday" {% if request.form.get('day_filter') == 'Tuesday' %}selected{% endif %}>–í—ñ–≤—Ç–æ—Ä–æ–∫</option>
                <option value="Wednesday" {% if request.form.get('day_filter') == 'Wednesday' %}selected{% endif %}>–°–µ—Ä–µ–¥–∞</option>
                <option value="Thursday" {% if request.form.get('day_filter') == 'Thursday' %}selected{% endif %}>–ß–µ—Ç–≤–µ—Ä</option>
                <option value="Friday" {% if request.form.get('day_filter') == 'Friday' %}selected{% endif %}>–ü'—è—Ç–Ω–∏—Ü—è</option>
            </select>
            <button type="submit">–ü–æ—à—É–∫</button>
        </form>

        <!-- –¢–∞–±–ª–∏—Ü—è —Ä–æ–∑–∫–ª–∞–¥—É -->
        {% if schedule %}
        <table>
            <thead>
                <tr>
                    <th><a href="?sort_by=–ì—Ä—É–ø–∞/–ü—ñ–¥–≥—Ä—É–ø–∞" class="{% if sort_by == '–ì—Ä—É–ø–∞/–ü—ñ–¥–≥—Ä—É–ø–∞' %}active{% endif %}">–ì—Ä—É–ø–∞/–ü—ñ–¥–≥—Ä—É–ø–∞</a></th>
                    <th><a href="?sort_by=–í–∏–∫–ª–∞–¥–∞—á" class="{% if sort_by == '–í–∏–∫–ª–∞–¥–∞—á' %}active{% endif %}">–í–∏–∫–ª–∞–¥–∞—á</a></th>
                    <th><a href="?sort_by=–ê—É–¥–∏—Ç–æ—Ä—ñ—è" class="{% if sort_by == '–ê—É–¥–∏—Ç–æ—Ä—ñ—è' %}active{% endif %}">–ê—É–¥–∏—Ç–æ—Ä—ñ—è</a></th>
                    <th><a href="?sort_by=–î–∏—Å—Ü–∏–ø–ª—ñ–Ω–∞" class="{% if sort_by == '–î–∏—Å—Ü–∏–ø–ª—ñ–Ω–∞' %}active{% endif %}">–î–∏—Å—Ü–∏–ø–ª—ñ–Ω–∞</a></th>
                    <th><a href="?sort_by=–¢–∏–ø –∑–∞–Ω—è—Ç—Ç—è" class="{% if sort_by == '–¢–∏–ø –∑–∞–Ω—è—Ç—Ç—è' %}active{% endif %}">–¢–∏–ø –∑–∞–Ω—è—Ç—Ç—è</a></th>
                    <th><a href="?sort_by=–ß–∞—Å" class="{% if sort_by == '–ß–∞—Å' %}active{% endif %}">–ß–∞—Å</a></th>
                </tr>
            </thead>
            <tbody>
                {% for slot in schedule %}
                <tr>
                    <td>{{ slot["–ì—Ä—É–ø–∞/–ü—ñ–¥–≥—Ä—É–ø–∞"] | safe }}</td>
                    <td>{{ slot["–í–∏–∫–ª–∞–¥–∞—á"] | safe }}</td>
                    <td>{{ slot["–ê—É–¥–∏—Ç–æ—Ä—ñ—è"] | safe }}</td>
                    <td>{{ slot["–î–∏—Å—Ü–∏–ø–ª—ñ–Ω–∞"] | safe }}</td>
                    <td>{{ slot["–¢–∏–ø –∑–∞–Ω—è—Ç—Ç—è"] }}</td>
                    <td>{{ slot["–ß–∞—Å"] }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
        {% else %}
        <p>–†–æ–∑–∫–ª–∞–¥ –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ. –ü–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—è, —â–æ schedule.csv —ñ—Å–Ω—É—î –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—ó desktop_app.</p>
        {% endif %}
    </div>

    <script>
        // –ü–µ—Ä–µ–º–∏–∫–∞–Ω–Ω—è —Ç–µ–º–∏ —Ç–∞ —ñ–∫–æ–Ω–∫–∏
        const toggleButton = document.getElementById('theme-toggle');
        const themeIcon = document.querySelector('.theme-icon');
        toggleButton.addEventListener('click', () => {
            document.body.classList.toggle('dark-theme');
            const isDark = document.body.classList.contains('dark-theme');
            themeIcon.textContent = isDark ? 'üåô' : '‚òÄÔ∏è';
            localStorage.setItem('theme', isDark ? 'dark' : 'light');
        });
        if (localStorage.getItem('theme') === 'dark') {
            document.body.classList.add('dark-theme');
            themeIcon.textContent = 'üåô';
        }
    </script>
</body>
</html>